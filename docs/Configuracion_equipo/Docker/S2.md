# S2 – Servidor de Aplicación PHP-FPM (Nodo 1)

## Objetivo de S2
Configuramos el servidor S2 utilizando una imagen de PHP-FPM sobre Alpine Linux para procesar la lógica dinámica de la aplicación. Su función principal es ejecutar el código de extagram.php, conectarse a la base de datos S7 para consultar los posts y generar el contenido HTML que se enviará de vuelta al balanceador S1.

Este nodo forma parte del clúster de Alta Disponibilidad. Si este contenedor fallara, el balanceador S1 redirigiría el tráfico automáticamente al nodo S3, garantizando que el servicio nunca se interrumpa.

## Configuración y Funcionamiento de S2
- **Despliegue del Contenedor:** El contenedor se levanta mediante Docker Compose, conectándose a las tres redes necesarias (entrada, servicios y datos) para interactuar con todos los niveles de la arquitectura. Se utiliza un volumen para sincronizar el código fuente en tiempo real.
  ```sql
  # Comando equivalente en Docker Run (aunque se gestiona vía Compose)
  docker run -d \
    --name s1-s2-phpfpm-1 \
    --network red_entrada \
    --network red_servicios \
    --network red_datos \
    -v /home/ec2-user/sprint2/S2/src:/var/www/extagram:rw \
    php:8.2-fpm-alpine
  ```
- **Estructura del contenedor:**
  ```sql
  S1/
  ├── docker-compose.yml   
  ├── extagram.php         
  └── s1-nginx/            
      ├── Dockerfile       
      └── extagram.conf    
  ```
  | Fichero | Función Técnica |
  |--------|------|
  | docker-compose.yml | Orquestrador: Define la red interna, los volúmenes compartidos y el orden de arranque de todos los contenedores (S1-S7). |
  | extagram.php | Interfaz de Usuario: Archivo principal que contiene el formulario de carga y la lógica para mostrar el feed de publicaciones desde la base de datos. |
  | s1-nginx/Dockerfile | Configurador de Imagen: Construye el servidor Nginx personalizado con las rutas de balanceo de carga. |
  | s1-nginx/extagram.conf | Motor de Rutas: Define que /storage/ va a S5, /static/ va a S6, y los ficheros .php se reparten entre S2 y S3. |

- **Contenido de ficheros:**
